<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Countdown to Exam End</title>
  <style>
    #howlongogogo_container {
      background-color: #ffffff;
      text-align: center;
      font-family: Arial, sans-serif;
      padding: 20px;
      border: 1px solid #ccc;
      max-width: 400px;
      margin: 40px auto;
      border-radius: 8px;
    }
    .subheading {
      color: #000000;
      font-size: 1.5em;
      margin-bottom: 10px;
    }
    .date_time_span {
      color: #000000;
      font-size: 1em;
      margin-bottom: 20px;
    }
    .date_span {
      color: #666666;
      font-size: 1.2em;
      margin: 10px;
    }
    .d-flex {
      display: flex;
      justify-content: space-around;
      flex-wrap: wrap;
    }
    .flex-fill {
      flex: 1;
    }
  </style>
</head>
<body>

<div id="howlongogogo_container"></div>

<script>
  const howlongagogo_options = {
    date: '2025-05-20',
    time: '10:30',
    offset: '+06:00',
    name: 'Exam end',
    name_color: '000000',
    date_color: '666666',
    bg_color: 'ffffff',
    show_date: true,
  };

  function addCommas(nStr) {
    nStr += '';
    var x = nStr.split('.');
    var x1 = x[0];
    var x2 = x.length > 1 ? '.' + x[1] : '';
    var rgx = /(\d+)(\d{3})/;
    while (rgx.test(x1)) {
      x1 = x1.replace(rgx, '$1' + ',' + '$2');
    }
    return x1 + x2;
  }

  function addHashIfNeeded(str) {
    return str.charAt(0) === '#' ? str : '#' + str;
  }

  function loadView() {
    const users_date = new Date(howlongagogo_options.date);
    const formattedDate = users_date.toLocaleDateString();
    const container = document.getElementById("howlongogogo_container");

    let html_markup = `
      <p class="subheading">${howlongagogo_options.name}</p>
    `;

    if (howlongagogo_options.show_date === true) {
      html_markup += `
        <p class="date_time_span">
          ${formattedDate}${howlongagogo_options.time !== '00:00:00' ? ' at ' + howlongagogo_options.time.slice(0, 5) : ''}
        </p>
      `;
    }

    html_markup += `
      <div class="d-flex">
        <div class="flex-fill date_span" id="countdown_days_accurate_html"><strong>&nbsp;</strong><br/>days</div>
        <div class="flex-fill date_span" id="countdown_hours_html"><strong>&nbsp;</strong><br/>hours</div>
        <div class="flex-fill date_span" id="countdown_minutes_html"><strong>&nbsp;</strong><br/>mins</div>
        <div class="flex-fill date_span" id="countdown_seconds_html"><strong>&nbsp;</strong><br/>secs</div>
      </div>
    `;

    container.innerHTML = html_markup;
  }

  function startCountdown() {
    const targetDate = new Date(howlongagogo_options.date + "T" + howlongagogo_options.time + howlongagogo_options.offset);

    let countdown = Math.floor((targetDate.getTime() - new Date().getTime()) / 1000);

    setInterval(() => {
      let days = Math.floor(countdown / 86400);
      let hours = Math.floor((countdown % 86400) / 3600);
      let minutes = Math.floor((countdown % 3600) / 60);
      let seconds = Math.floor(countdown % 60);

      document.getElementById('countdown_days_accurate_html').innerHTML = `<strong>${addCommas(Math.max(0, days))}</strong><br/>days`;
      document.getElementById('countdown_hours_html').innerHTML = `<strong>${addCommas(Math.max(0, hours))}</strong><br/>hours`;
      document.getElementById('countdown_minutes_html').innerHTML = `<strong>${addCommas(Math.max(0, minutes))}</strong><br/>mins`;
      document.getElementById('countdown_seconds_html').innerHTML = `<strong>${addCommas(Math.max(0, seconds))}</strong><br/>secs`;

      countdown--;
    }, 1000);
  }

  // Run everything
  loadView();
  startCountdown();
</script>

</body>
</html>
